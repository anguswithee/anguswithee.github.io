{
  "hash": "39f4aff52a3dd5d6717c611785a0e51c",
  "result": {
    "markdown": "---\ntitle: \"North Carolina Public School Demographics (2014-2024)\"\ndate: last-modified\ndate-format: \"[Last modified on] MMMM DD, YYYY HH:mm:ss zzz\"\nformat: \n  html:\n    output: bookdown::html_document2\n    fig_caption: yes\n    theme: cosmo  # zephyr pulse, sketchy, default, cosmo, vapor etc\nauthor:\n  - name: Angus Victor Withee\n    email: witheeav@appstate.edu\n    affiliation:\n      - name: Appalachian State University\n        city: Boone\n        state: NC  \n        url: https://www.appstate.edu/\nkeywords:\n  - R\n  - data viz\nlicense: \"CC BY\"  \ncode-fold: false\n---\n\n# Introduction\n\nThis is an exploration and visualization of North Carolina public school demographic data from February 2014 to February 2024. All data was obtained from the North Carolina Public School Statistical Profile (http://apps.schools.nc.gov/ords/f?p=145:1).\n\n\n\n\n\n## Loading Necessary Packages\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(lubridate)\nlibrary(tidyr)\nlibrary(ggmap)\nlibrary(mapproj)\nlibrary(ggplot2)\nlibrary(caret)\n```\n:::\n\n\n## Importing Data\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndemographics <- read.csv(\"~/STT2860/anguswithee.github.io/demographics.csv\")\n```\n:::\n\n\n## Variables\n\n`demographics`\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,270\nColumns: 17\n$ Year                   <chr> \"2014\", \"2014\", \"2014\", \"2014\", \"2014\", \"2014\",…\n$ LEA.Name               <chr> \"Alamance-Burlington Schools\", \"Alexander Count…\n$ INDIAN.Male            <int> 46, 4, 2, 8, 0, 6, 5, 0, 7, 7, 26, 59, 52, 9, 6…\n$ INDIAN.Female          <int> 51, 7, 2, 5, 3, 9, 3, 2, 3, 5, 35, 55, 33, 11, …\n$ ASIAN.Male             <int> 158, 51, 1, 29, 10, 33, 18, 4, 7, 4, 3, 42, 159…\n$ ASIAN.Female           <int> 141, 50, 2, 25, 7, 41, 36, 8, 10, 2, 4, 38, 216…\n$ HISPANIC.Male          <int> 2657, 213, 154, 57, 165, 980, 135, 108, 495, 26…\n$ HISPANIC.Female        <int> 2600, 212, 147, 66, 133, 934, 161, 109, 492, 27…\n$ BLACK.Male             <int> 2462, 107, 8, 1030, 9, 351, 511, 3, 1201, 1075,…\n$ BLACK.Female           <int> 2297, 100, 3, 1046, 7, 342, 484, 3, 1118, 1049,…\n$ WHITE.Male             <int> 5897, 2232, 551, 623, 1411, 911, 1317, 934, 179…\n$ WHITE.Female           <int> 5423, 2121, 572, 620, 1372, 938, 1257, 941, 163…\n$ PACIFIC.ISLAND..Male   <int> 18, 0, 0, 0, 0, 0, 5, 1, 2, 1, 2, 5, 33, 5, 15,…\n$ PACIFIC.ISLAND..Female <int> 12, 1, 0, 0, 0, 3, 2, 1, 2, 1, 0, 6, 30, 4, 24,…\n$ TWO.OR.MORE.Male       <int> 422, 102, 13, 46, 28, 77, 162, 18, 128, 21, 103…\n$ TWO.OR.MOREFemale      <int> 431, 90, 16, 47, 29, 99, 134, 23, 128, 19, 104,…\n$ Total                  <int> 22615, 5290, 1471, 3602, 3174, 4724, 4230, 2155…\n```\n:::\n:::\n\n\nThere are 17 variables in the `demographics` data frame.\n\n1. `year`: The year the data was collected (2014-2024).\n2. `LEA.Name`: The name of the county or counties in which the data was collected.\n3. `Indian Male`: The number of Indigenous male students in the given county each year.\n4. `Indian Female`: The number of Indigenous female students in the given county each year.\n5. `Asian Male`: The number of Asian male students in the given county each year.\n6. `Asian Female`: The number of Asian female students in the given county each year.\n7. `Hispanic Male`: The number of Hispanic male students in the given county each year.\n8. `Hispanic Female`: The number of Hispanic female students in the given county each year.\n9. `Black Male`: The number of Black male students in the given county each year.\n10. `Black Female`: The number of Black male students in the given county each year.\n11. `White Male`: The number of White male students in the given county each year.\n12. `White Female`: The number of White female students in the given county each year.\n13. `Pacific Island Male`: The number of Pacific Island male students in the given county each year.\n14. `Paicific Island Female`: The number of Hispanic female students in the given county each year.\n15. `Two or More Male`: The number of male students who identify with two or more races in the given county each year.\n16. `Two or More Female`: The number of female students who identify with two or more races in the given county each year.\n17. `Total`: The total number of students in the given county each year.\n\n## Data Wrangling\n\nTo make the data ideal for visualization, merge and rename variables.\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndemographics <- demographics |> \n  group_by(Year,LEA.Name) |>\n  summarize(aapi_male = ASIAN.Male+PACIFIC.ISLAND..Male,\n            aapi_female = ASIAN.Female+PACIFIC.ISLAND..Female,\n            indigenous_male = INDIAN.Male,\n            indigenous_female = INDIAN.Female,\n            hispanic_male = HISPANIC.Male,\n            hispanic_female = HISPANIC.Female,\n            black_male = BLACK.Male,\n            black_female = BLACK.Female,\n            white_male = WHITE.Male,\n            white_female = WHITE.Female,\n            multiracial_male = TWO.OR.MORE.Male,\n            multiracial_female = TWO.OR.MOREFemale)\ndemographics <- demographics |> filter (Year>1)\n```\n:::\n\nThen, reshape the dataset from a wide format to a long format. \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndemographics <- demographics |> \n  select(Year, LEA.Name, \n         aapi_male, aapi_female, \n         indigenous_male, indigenous_female, \n         hispanic_male, hispanic_female, \n         black_male, black_female, \n         white_male, white_female, \n         multiracial_male, multiracial_female) |> \n  pivot_longer(\n    cols = starts_with(\"aapi\") | starts_with(\"indigenous\") | \n           starts_with(\"hispanic\") | starts_with(\"black\") | \n           starts_with(\"white\") | starts_with(\"multiracial\"),\n    names_to = c(\"race\", \"sex\"),\n    names_pattern = \"(.*)_(male|female)\",\n    values_to = \"count\"\n  )\ndemographics$Year <- as.numeric(demographics$Year)\nhead(demographics)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n# Groups:   Year [1]\n   Year LEA.Name                    race       sex    count\n  <dbl> <chr>                       <chr>      <chr>  <int>\n1  2014 Alamance-Burlington Schools aapi       male     176\n2  2014 Alamance-Burlington Schools aapi       female   153\n3  2014 Alamance-Burlington Schools indigenous male      46\n4  2014 Alamance-Burlington Schools indigenous female    51\n5  2014 Alamance-Burlington Schools hispanic   male    2657\n6  2014 Alamance-Burlington Schools hispanic   female  2600\n```\n:::\n:::\n\n# Data Visualization\n\n## NC Public School Demographics (2024)\n\nBefore we look at changes over time, let's start by looking at demographics in 2024.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndemo2024 <- demographics |>\n  filter(Year==2024)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(demo2024, aes(x = race, y = count, fill = race)) +\n  geom_bar(stat = \"identity\") +\n  labs(\n    x = \"Race\",\n    y = \"Number of Students\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(hjust = 0.5),\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  ) + guides(fill=\"none\") +\n  theme(panel.border = element_rect(color = \"black\", fill = NA, size = 1))\n```\n\n::: {.cell-output-display}\n![Figure 1: NC Public School Students by Race (2024).](p2_files/figure-html/fig1-1.png){fig-align='center' width=672}\n:::\n:::\n\n\nNC Public School Demographics by Sex (2024)\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(demo2024, aes(x = sex, y = count, fill = sex)) +\n  geom_bar(stat = \"identity\") +\n  labs(\n    x = \"Sex\",\n    y = \"Number of Students\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(hjust = 0.5),\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  ) +\n  theme(panel.border = element_rect(color = \"black\", fill = NA, size = 1))\n```\n\n::: {.cell-output-display}\n![Figure 2: NC Public School Demographics by Sex (2024).](p2_files/figure-html/fig2-1.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(demo2024, aes(x = race, y = count, fill = sex)) +\n  geom_bar(stat = \"identity\") +\n  labs(\n    x = \"Race\",\n    y = \"Number of Students\"\n  ) + \n  theme_minimal() +\n  theme(\n    plot.title = element_text(hjust = 0.5),\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  ) +\n  theme(panel.border = element_rect(color = \"black\", fill = NA, size = 1))\n```\n\n::: {.cell-output-display}\n![Figure 3: NC Public School Demographics by Race and Sex (2024).](p2_files/figure-html/fig3-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n## NC Public School Demographics Over Time\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndemographic_trends <- demographics |> \n  group_by(Year, race, sex) |> \n  summarize(total_count = sum(count, na.rm = TRUE), .groups = \"drop\")\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(demographic_trends, aes(x = Year, y = total_count, color = race)) +\n  geom_smooth(method = \"loess\", se = FALSE, size = 1)+\n  labs(\n    x = \"Year\",\n    y = \"Total Count\"\n  ) +\n  scale_x_continuous(breaks = unique(demographic_trends$Year)) + # Show all years\n  scale_y_continuous(labels = scales::comma) +\n    theme_minimal() +\n    theme(panel.border = element_rect(color = \"black\", fill = NA, size = 1))\n```\n\n::: {.cell-output-display}\n![Figure 4: NC Public School Racial Demographic Trends (2024).](p2_files/figure-html/fig4-1.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(demographic_trends, aes(x = Year, y = total_count, color = race, linetype = sex)) +\n  geom_line(size = 1) +\n  labs(\n    x = \"Year\",\n    y = \"Total Count\"\n  ) +\n  scale_x_continuous(breaks = unique(demographic_trends$Year)) + # Show all years\n  scale_y_continuous(labels = scales::comma) +\n    theme_minimal() +\n    theme(panel.border = element_rect(color = \"black\", fill = NA, size = 1))\n```\n\n::: {.cell-output-display}\n![Figure 5: NC Public School Race and Sex Demographic Trends (2014-2024).](p2_files/figure-html/fig5-1.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nwhite_total <- demographic_trends |> \n  filter(race == \"white\") |> \n  group_by(Year) |> \n  summarize(white_count = sum(total_count), .groups = \"drop\")\n\ntotal_count_by_year <- demographic_trends |> \n  group_by(Year) |> \n  summarize(total_students = sum(total_count, na.rm = TRUE), .groups = \"drop\")\n\npoc_data <- left_join(total_count_by_year, white_total, by = \"Year\") |> \n  mutate(poc_percentage = 100 * (total_students - white_count) / total_students)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(poc_data, aes(x = Year, y = poc_percentage)) +\n  geom_line(size = 1) +\n  labs(\n    x = \"Year\",\n    y = \"Percentage of Students of Color\"\n  ) +\n  theme_minimal() +\n  scale_y_continuous(limits = c(0, 100),labels = scales::percent_format(scale = 1)) +\n    scale_x_continuous(breaks = unique(demographic_trends$Year))\n```\n\n::: {.cell-output-display}\n![Figure 6: NC Public School Percentage of Students of Color Over Time (2014-2024).](p2_files/figure-html/fig6-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n## Watauga County Public School Demographics\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nwata_demo <- demographics |>\n  filter(LEA.Name==\"Watauga County Schools\")\n\nwata_demo2024 <- wata_demo |>\n  filter(Year==2024)\n\nwata_demo_trends <- wata_demo |>\n  group_by(Year, race, sex) |> \n  summarize(total_count = sum(count, na.rm = TRUE), .groups = \"drop\")\n\nwata_white_total <- wata_demo_trends |>\n  filter(race == \"white\") |> \n  group_by(Year) |> \n  summarize(white_count = sum(total_count), .groups = \"drop\")\n\nwata_total_count_by_year <- wata_demo_trends |>\n  group_by(Year) |> \n  summarize(total_students = sum(total_count, na.rm = TRUE), .groups = \"drop\")\n\nwata_poc_data <- left_join(wata_total_count_by_year, wata_white_total, by = \"Year\") |> \n  mutate(poc_percentage = 100 * (total_students - white_count) / total_students)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(wata_demo2024, aes(x = race, y = count, fill = race)) +\n  geom_bar(stat = \"identity\") +\n  labs(\n    x = \"Race\",\n    y = \"Number of Students\"\n  ) +\n  theme_minimal() + \n  guides(fill=\"none\") +\n  theme(\n    plot.title = element_text(hjust = 0.5),\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  ) +\n  theme(panel.border = element_rect(color = \"black\", fill = NA, size = 1))\n```\n\n::: {.cell-output-display}\n![Figure 7: Watauga County Public School Demographics by Race and Sex (2024).](p2_files/figure-html/fig7-1.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(wata_demo_trends, aes(x = Year, y = total_count, color = race, linetype = sex)) +\n  geom_line(size = 1) +\n  labs(\n    x = \"Year\",\n    y = \"Total Count\"\n  ) +\n  scale_x_continuous(breaks = unique(demographic_trends$Year)) + # Show all years\n  scale_y_continuous(labels = scales::comma) +\n    theme_minimal() +\n    theme(panel.border = element_rect(color = \"black\", fill = NA, size = 1))\n```\n\n::: {.cell-output-display}\n![Figure 8: Watauga County Public School Race and Sex Demographics Over Time (2014-2024)](p2_files/figure-html/fig8-1.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(wata_poc_data, aes(x = Year, y = poc_percentage)) +\n  geom_line(size = 1) +\n  labs(\n    x = \"Year\",\n    y = \"Percentage of Students of Color\"\n  ) +\n  theme_minimal() +\n  scale_y_continuous(limits = c(0, 100),labels = scales::percent_format(scale = 1)) +\n    scale_x_continuous(breaks = unique(demographic_trends$Year))\n```\n\n::: {.cell-output-display}\n![Figure 9: Watauga County Public School Percentage of Students of Color Over Time (2014-2024).](p2_files/figure-html/fig9-1.png){fig-align='center' width=672}\n:::\n:::\n",
    "supporting": [
      "p2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}